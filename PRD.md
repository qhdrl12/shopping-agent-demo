# Product Requirements Document (PRD)
## 무신사 쇼핑 AI 에이전트 시스템

### 1. 프로젝트 개요

**프로젝트명**: 무신사 쇼핑 AI 에이전트 시스템  
**목적**: LangGraph 기반으로 Firecrawl을 활용한 지능형 쇼핑 에이전트 개발  
**대상 플랫폼**: 무신사 (musinsa.com)  
**참고 프로젝트**: [langgraph-agent-playground](https://github.com/qhdrl12/langgraph-agent-playground)

### 2. 핵심 기능 요구사항

#### 2.1 AI 에이전트 아키텍처 (LangGraph 기반)
- **멀티 에이전트 시스템**: Supervisor 패턴 적용
  - **Search Agent**: 무신사 내 제품 검색 전담
  - **Scrape Agent**: 상세 제품 정보 스크래핑 전담
  - **Analysis Agent**: 수집된 정보 분석 및 추천 로직
  - **Response Agent**: 사용자 질문에 대한 최종 답변 생성

#### 2.2 Firecrawl 도구 통합
- **Search 기능**: 무신사 내 제품 검색 (`/search` endpoint)
- **Scrape 기능**: 제품 상세 페이지 스크래핑 (`/scrape` endpoint)
- **Extract 기능**: 구조화된 데이터 추출 (`/extract` endpoint)

#### 2.3 워크플로우 설계
```
사용자 질문 → Search Agent → Scrape Agent → Analysis Agent → Response Agent → 답변
```

**단계별 프로세스**:
1. **검색 단계**: 사용자 질문 분석 → 키워드 추출 → 무신사 검색 수행
2. **스크래핑 단계**: 검색 결과 URL들 → 상세 정보 스크래핑 → 데이터 추출
3. **분석 단계**: 수집된 데이터 분석 → 사용자 요구사항 매칭 → 추천 로직 적용
4. **응답 단계**: 분석 결과 → 자연어 응답 생성 → 사용자에게 전달

### 3. 기술 스택

#### 3.1 백엔드
- **Python 3.11+**
- **uv**: Python 패키지 관리 및 가상환경
- **LangGraph**: 에이전트 워크플로우 관리
- **LangChain**: LLM 통합 및 도구 연동
- **Firecrawl API**: 웹 스크래핑 및 데이터 추출
- **FastAPI**: 웹 API 서버
- **Pydantic**: 데이터 검증 및 스키마 정의
- **OpenAI API / OpenRouter**: LLM 모델 지원

#### 3.2 프론트엔드
- **React 18+** with TypeScript
- **Next.js 14+**: 풀스택 웹 프레임워크
- **Tailwind CSS**: 스타일링
- **SWR**: 데이터 페칭 및 캐싱
- **React Query**: 서버 상태 관리

#### 3.3 개발 도구
- **uv**: Python 패키지 관리 및 가상환경
- **pytest**: 테스트 프레임워크
- **LangSmith**: 프롬프트 관리 및 모니터링
- **ESLint/Prettier**: 코드 품질 관리

### 4. 웹 UI/UX 요구사항

#### 4.1 채팅 인터페이스
- **실시간 스트리밍**: 에이전트 응답의 실시간 스트리밍
- **메시지 타입 구분**:
  - 사용자 메시지: 일반 채팅 버블
  - AI 메시지: 구분된 스타일
  - 도구 메시지: 접이식 디버그 패널
  - 시스템 메시지: 상태 표시

#### 4.2 워크플로우 가시화
- **진행 상황 표시**: 각 에이전트 단계별 진행률
- **도구 호출 로그**: Firecrawl 호출 내역 및 결과
- **에러 핸들링**: 실패 시 상세 오류 정보 표시

#### 4.3 프롬프트 관리 인터페이스
- **에이전트별 프롬프트 편집기**: 실시간 프롬프트 수정
- **테스트 모드**: 프롬프트 변경 사항 즉시 테스트
- **버전 관리**: 프롬프트 변경 이력 추적

### 5. 무신사 특화 기능

#### 5.1 검색 최적화
- **카테고리 인식**: 의류, 신발, 액세서리 등 카테고리별 검색
- **브랜드 필터링**: 특정 브랜드 제품 검색
- **가격 범위**: 예산 범위 내 제품 검색
- **리뷰 점수**: 평점 기반 제품 필터링

#### 5.2 데이터 추출 스키마
```json
{
  "product": {
    "name": "string",
    "brand": "string",
    "price": "number",
    "discount_price": "number",
    "rating": "number",
    "review_count": "number",
    "category": "string",
    "colors": ["string"],
    "sizes": ["string"],
    "images": ["string"],
    "description": "string",
    "features": ["string"]
  }
}
```

#### 5.3 질문 유형별 대응
- **제품 추천**: "20만원 이하 겨울 코트 추천해줘"
- **비교 분석**: "나이키 vs 아디다스 운동화 비교"
- **트렌드 분석**: "요즘 인기 있는 스트리트 브랜드는?"
- **스타일링 제안**: "이 바지와 어울리는 상의 추천"

### 6. 성능 및 품질 요구사항

#### 6.1 응답 시간
- **검색 응답**: 3초 이내
- **스크래핑 완료**: 10초 이내
- **전체 워크플로우**: 15초 이내

#### 6.2 정확도
- **제품 정보 정확도**: 95% 이상
- **가격 정보 정확도**: 100% (실시간 반영)
- **재고 상태 정확도**: 90% 이상

#### 6.3 에러 처리
- **네트워크 타임아웃**: 자동 재시도 (최대 3회)
- **API 제한**: Rate limiting 및 백오프 전략
- **스크래핑 실패**: 대체 데이터 소스 활용

### 7. 개발 및 배포

#### 7.1 개발 환경
- **로컬 개발**: Docker Compose 환경 구성
- **환경 변수**: API 키 및 설정 관리
- **핫 리로드**: 프롬프트 및 코드 변경 시 자동 반영

#### 7.2 테스트 전략
- **단위 테스트**: 각 에이전트 및 도구 함수
- **통합 테스트**: 전체 워크플로우 시나리오
- **E2E 테스트**: 실제 무신사 데이터 기반 테스트

#### 7.3 모니터링
- **LangSmith 통합**: 에이전트 성능 추적
- **API 사용량**: Firecrawl API 호출 통계
- **사용자 만족도**: 응답 품질 피드백 수집

### 8. 확장성 고려사항

#### 8.1 다중 쇼핑몰 지원
- **플러그인 아키텍처**: 다른 쇼핑몰 추가 가능
- **사이트별 스크래핑 전략**: 각 사이트 특성 반영

#### 8.2 개인화 기능
- **사용자 선호도 학습**: 과거 검색 및 구매 패턴
- **맞춤형 추천**: 개인별 취향 반영

#### 8.3 실시간 업데이트
- **가격 변동 알림**: 관심 상품 가격 추적
- **재고 알림**: 품절 상품 재입고 알림

### 9. 웹 스크래핑 윤리
- **robots.txt 준수**: 크롤링 규칙 준수
- **적절한 요청 간격**: 서버 부하 최소화
- **캐싱 전략**: 불필요한 중복 요청 방지